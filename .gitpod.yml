# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.

tasks:
  - name: (StatusBoard) Installing dependencies and running app
    init: |
      echo 'ü¶Ñ üì¶ Installing all dependencies'
      yarn
    command: |
      echo 'ü¶Ñ Running Status Board application'
      yarn dev 
    ## HOPR net repositories
  - name: (HOPRd) Installing hoprnet which contains the required scripts
    command: |
      echo 'üü° üì¶ Setting up hoprnet repository'
      curl -L https://github.com/hoprnet/hoprnet/archive/refs/heads/release/lisbon.zip > hoprnet.zip
      unzip hoprnet.zip
      cd hoprnet-release-lisbon
      echo 'üü° üì¶ Installing hoprnet repository dependencies'
      yarn
      echo 'üü° üì¶ Building latest version of hoprnet monorepo'
      yarn build
      echo 'üü° Waiting for StatusBoard'
      gp await-port 3000
      echo 'üü° Running HOPR nodes and topology'
      ./scripts/setup-local-cluster.sh -m "$(gp url 3000)" -i scripts/topologies/full_interconnected_cluster.sh
    openMode: split-right
  - name: (StatusBoard) URLs
    command: |
      echo 'üö¶ Waiting on all nodes...'
      gp await-port 13301
      gp await-port 13302
      gp await-port 13303
      gp await-port 13304
      gp await-port 13305
      echo 'üö¶ Nodes Dashboard'
      echo -e "\n"
      echo -e "\t1Ô∏è‚É£  Alex"
      echo -e "\t\tStatusBoard: $(gp url 3000)/?nodeHost=$(gp url)&securityToken=^^LOCAL-testing-123^^"
      echo -e "\t\tHopr API:\t$(gp url 13301)/api/v2/_swagger"
      echo -e "\t\tAdmin UI:\t$(gp url 19501)/"
      echo -e "\n"
      echo -e "\t2Ô∏è‚É£  Betty"
      echo -e "\t\tStatusBoard: $(gp url 3000)/?nodeHost=$(gp url)&securityToken=^^LOCAL-testing-123^^"
      echo -e "\t\tHopr API:\t$(gp url 13302)/api/v2/_swagger"
      echo -e "\t\tAdmin UI:\t$(gp url 19502)/"
      echo -e "\n"
      echo -e "\t3Ô∏è‚É£  Ch√£o"
      echo -e "\t\tStatusBoard: $(gp url 3000)/?nodeHost=$(gp url)&securityToken=^^LOCAL-testing-123^^"
      echo -e "\t\tHopr API:\t$(gp url 13303)/api/v2/_swagger"
      echo -e "\t\tAdmin UI:\t$(gp url 19503)/"
      echo -e "\n"
      echo -e "\t4Ô∏è‚É£  Dmytro"
      echo -e "\t\tStatusBoard: $(gp url 3000)/?nodeHost=$(gp url)&securityToken=^^LOCAL-testing-123^^"
      echo -e "\t\tHopr API:\t$(gp url 13304)/api/v2/_swagger"
      echo -e "\t\tAdmin UI:\t$(gp url 19504)/"
      echo -e "\n"
      echo -e "\t5Ô∏è‚É£  Zoe"
      echo -e "\t\tStatusBoard: $(gp url 3000)/?nodeHost=$(gp url)&securityToken=^^LOCAL-testing-123^^"
      echo -e "\t\tHopr API:\t$(gp url 13305)/api/v2/_swagger"
      echo -e "\t\tAdmin UI:\t$(gp url 19505)/"
    openMode: tab-after

ports:
  - name: StatusBoard
    port: 3000
    visibility: public
  - name: HOPRd REST API
    port: 13301-13305
    visibility: public
  - name: HOPR protocol
    port: 19091-19095
    visibility: public
  - name: HOPRd Admin
    port: 19501-19505
    visibility: public
